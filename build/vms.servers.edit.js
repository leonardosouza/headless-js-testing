/*! headless 2014-06-03 */

var Cloud=Cloud||{};Cloud.modules=Cloud.modules||{},Cloud.modules.vms=Cloud.modules.vms||{},Cloud.modules.vms.serversEdit=function(a){a.init=function(b){"MANAGE_SERVER"===b&&(a.instanceLabels(["#fieldservername","#fieldescription"],["#save","#cancel","#modify"],[".editable",".not-editable"]),a.connect("#connect-server, .ligar-servidor a, .start-server"),a.disconnect("#disconnect-server","disconnect"),a.restart("#restart-server, .reiniciar-servidor a, #reiniciar-servidor, #ip-reset"),a.changeOperatingSystem("#modify-os"),a.acessApp("#acess-app"),a.attachDisk(".attach-disk"),a.createBackup(".backup-create"),a.deleteBackup(".backup-delete"),a.abortBackup(".abort-backup",".abort-update"),a.updateBackup(".backup-update"),a.restoreBackup(".backup-restore"),a.cancelScheduling(".cancel-request"),a.showPassword("#viewPassword"),a.cancelPlan("#cancel-server"),a.upgradeOrDowngrade(".up-down-grade"),a.detachFreeDisk(".detach-free-disk"),a.submitToPage(["#poweroff-server","#change-plan","#change-os","#cancel-instance","#view-history","#view-monitoring",".manage-firewall",".contract-ip"]),a.viewContactData(),a.updatePageElements(),a.updateStatusIp(".solicitarIp, .solicitarIpDesligado"),a.privateIpProcedureCentOS("#active-ip-centos"),a.copyHeight(".status",".system-installed",".access",".external-disks",".backup",".load-balancing"),a.controlBackupType(".type-backup"),a.generalScheduling(".btn-schedule"),a.backupImmediate(".backup-immediate"),a.backupTips(".tips a"),a.showBackupInfo(".backup-edit"),a.updateBackupInfo(".edit"))},a.instanceLabels=function(b,c,d,e){a.controlFields(b),a.saveLabels(d,b,c[0],e),a.cancelLabels(d,c[1]),a.modifyLabels(d,b,c[2]),$("#external-disks dl:last").addClass("last")},a.controlFields=function(b){var c,d=function(){a.parentIframeAdjust($("#container")[0].offsetHeight)},e=function(c){""!==$.trim($("#fieldservername").val())&&$(".editable #fieldservername").attr("rel",$("#fieldservername").val()),$(".editable #fieldescription").attr("rel",$("#fieldescription").val()),""===$.trim($(b[c.data.i]).val())&&($(this).val($(this).attr("rel")),a.parentIframeAdjust($("#container")[0].offsetHeight))};$("#manage").unbind("submit");for(c in b)$(b[c]).click(d).blur({i:c},e)},a.saveLabels=function(b,c,d,e){a.sendFormByReturn($("#fieldservername"),$(d)),$(d).unbind().click(function(){var b=$.trim($("#fieldservername").val())||$("#fieldservername").attr("rel"),c=e||!1,d=["crossdomain="+c,"idtServer="+$(this).attr("rel"),"serverName="+encodeURI(b)];return a.ajaxJson("/virtual-machines/servers/edit/update.json",d.join("&"),{method:"POST",fnBeforeSend:a.genericWaiting,fnSuccess:a.instanceLabelsSuccess,fnError:a.genericCallbackError}),!1})},a.cancelLabels=function(a,b){$(b).unbind().click(function(){return $(this).hasClass("disabled")?!1:($(a[0]).addClass("hide"),void $(a[1]).removeClass("hide"))})},a.modifyLabels=function(a,b,c){$(c).unbind().click(function(){""===$.trim($(b[0]).val())&&$(b[0]).val($(b[0]).attr("rel")),$(a[0]).removeClass("hide"),$(a[1]).addClass("hide")})},a.instanceLabelsSuccess=function(b){var c=b.update||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=$.trim(c.serverName)||$("#fieldservername").attr("rel");$(".not-editable .servername").html(g),tb_remove(),a.heightModal(),$(".editable").addClass("hide"),$(".not-editable").removeClass("hide"),$("#cancel").removeClass("disabled"),$("#msg-error").hasClass("hide")||$("#msg-error").addClass("hide"),"true"==c.crossdomain&&a.setAppName("https://loja.host.uol.com.br/service/upd/app-name.json",$("input#fieldapp").val(),g)}(d||e)&&(a.errorHandler("#msg-error",d,e,f,!1),a.heightModal(),$(".editable").addClass("hide"),$(".editable").addClass("hide"),$(".not-editable").removeClass("hide"),$("#cancel").removeClass("disabled"))},a.disconnect=function(b,c){$(b).unbind().click(function(){if($(this).hasClass("disabled"))return!1;$("#rebootIp").hasClass("hide")||$("#rebootIp").addClass("hide");var b=[];b.push("idtServer="+$(this).attr("rel")),b.push("origin="+c),a.ajaxJson("/virtual-machines/servers/edit/disconnect.json",b.join("&"),{method:"POST",fnBeforeSend:a.disconnectWaiting,fnSuccess:a.disconnectSuccess,fnError:a.genericCallbackError})})},a.disconnectWaiting=function(){$("dl.status dd").eq(0).html("Desligando"),a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,["#poweroff-server",".contract-ip"]),a.hideAllMessages(),$("#msg-disconnect-wait").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)},a.disconnectSuccess=function(b){var c=b.stop||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=[];g.push("idtServer="+c.controlRequest),g.push("origin="+c.origin),a.CONTROL_INTERVAL=setInterval(function(){a.ajaxJson("/virtual-machines/servers/edit/get.json",g.join("&"),{method:"POST",fnSuccess:function(b){var c,d,e=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;if(e&&"STOPPED"==e.statusLabel){for($("dl.status dd").eq(0).html("Desligado"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,e),a.hideAllMessages(),c=0,d=e.statusAdditionalAddress.length;d>c;c++)"ASSIGNED"!=e.statusAdditionalAddress[c]&&($(".reboot span.reiniciar-servidor").addClass("hide"),$(".reboot span.ligar-servidor").removeClass("hide"));$(".reiniciar span.reiniciar-servidor").hasClass("hide")||($(".reiniciar span.ligar-servidor").removeClass("hide"),$(".reiniciar span.reiniciar-servidor").addClass("hide")),$(".solicitarIp").attr("rel","solicitarIpDesligado").removeClass("disabled"),"upgradedowngrade"==e.origin?$("#msg-updown-ok").add("#connect-server").removeClass("hide"):"changeso"==e.origin?$("#msg-change-so-ok").add("#connect-server").removeClass("hide"):"changeso-all"==e.origin?$("#msg-change-so-all-ok").add("#connect-server").removeClass("hide"):"licenses-all"==e.origin?$("#msg-licenses-all-ok").add("#connect-server").removeClass("hide"):"cancel"==e.origin?$("#msg-cancel-ok").add("#connect-server").removeClass("hide"):"cancel-all"==e.origin?$("#msg-cancel-all-ok").add("#connect-server").removeClass("hide"):$("#msg-disconnect-ok").add("#connect-server").removeClass("hide"),$("#disconnect-server").addClass("hide"),$("#rebootIp").hasClass("hide")||$("#rebootIp").addClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null}a.errorHandler("#msg-disconnect-error",f,g,h,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},a.TIME_LATENCY)}a.errorHandler("#msg-disconnect-error",d,e,f,!1)},a.connect=function(b){$(b).live("click",function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).addClass("disabled"),$(".restart-ip .reboot .ligar-servidor").is(":visible")?a.atualizaLabelIp("Definindo",".reboot span.ligar-servidor"):a.atualizaLabelIp("Definindo",".reboot span.reiniciar-servidor");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/edit/connect.json",c.join("&"),{method:"POST",fnBeforeSend:a.connectWaiting,fnSuccess:a.connectSuccess,fnError:a.genericCallbackError})})},a.connectWaiting=function(){$("dl.status dd").eq(0).html("Ligando"),a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,["#poweroff-server",".contract-ip"]),a.hideAllMessages(),$("#msg-connect-wait").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)},a.connectSuccess=function(b){var c=b.start||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=[];g.push("idtServer="+c.controlRequest),a.CONTROL_INTERVAL=setInterval(function(){a.ajaxJson("/virtual-machines/servers/edit/get.json",g.join("&"),{method:"POST",fnSuccess:function(b){var c,d,e=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;if("true"==e.rebootPrivate&&($(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reiniciar span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reiniciar span.ligar-servidor")),"true"==e.rebootPublicIp&&($(".reboot span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reboot span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reboot span.ligar-servidor")),$(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaIpPrivado(e.privateAddresses,".reiniciar span.reiniciar-servidor"):a.atualizaIpPrivado(e.privateAddresses,".reiniciar span.ligar-servidor"),e&&"RUNNING"==e.statusLabel){for($("dl.status dd").eq(0).html("Ligado"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,e),a.hideAllMessages(),c=0,d=e.statusAdditionalAddress.length;d>c;c++)"ASSIGNED"==e.statusAdditionalAddress[c]&&$("div.reboot").addClass("hide");if($(".ips tbody tr:first td.central:first").text().indexOf("Definindo")>=0){var i=$(".ips tbody tr:first td.central:first").html();i=i.replace("Definindo",e.planDetails.ip),$(".ips tbody tr:first td.central:first").html(i),$(".ips tbody tr:first td:last a").attr("rel",e.planDetails.ipId)}""!==e.publicAddressesIp&&($(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaIpPublico(e.publicAddresses,e.publicAddressesIp,e.statusAdditionalAddress):a.atualizaIpPublico(e.publicAddresses,e.publicAddressesIp,e.statusAdditionalAddress)),$("#rebootIp").hasClass("hide")||$("#rebootIp").addClass("hide"),$("#msg-connect-ok").add("#disconnect-server").removeClass("hide"),$("#connect-server").addClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null}a.errorHandler("#msg-connect-error",f,g,h,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},a.TIME_LATENCY)}a.errorHandler("#msg-connect-error",d,e,f,!1)},a.restart=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;if($("#rebootIp").addClass("hide"),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/edit/restart.json",c.join("&"),{method:"POST",fnBeforeSend:a.restartWaiting,fnSuccess:a.restartSuccess,fnError:a.genericCallbackError})})},a.restartWaiting=function(){$("dl.status dd").eq(0).html("Reiniciando"),a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,["#poweroff-server",".contract-ip"]),a.hideAllMessages(),$("#msg-restart-wait").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)},a.restartSuccess=function(b){var c=b.restart||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=[];g.push("idtServer="+c.controlRequest),a.CONTROL_INTERVAL=setInterval(function(){a.ajaxJson("/virtual-machines/servers/edit/get.json",g.join("&"),{method:"POST",fnSuccess:function(b){var c,d,e=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;if("true"==e.rebootPrivate&&($(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reiniciar span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reiniciar span.ligar-servidor")),"true"==e.rebootPublicIp&&($(".reboot span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reboot span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reboot span.ligar-servidor")),$(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaIpPrivado(e.privateAddresses,".reiniciar span.reiniciar-servidor"):a.atualizaIpPrivado(e.privateAddresses,".reiniciar span.ligar-servidor"),e&&"RUNNING"==e.statusLabel){for($("dl.status dd").eq(0).html("Ligado"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,e),a.hideAllMessages(),$("#msg-restart-ok").add("#disconnect-server").removeClass("hide"),$("#connect-server").addClass("hide"),c=0,d=e.statusAdditionalAddress.length;d>c;c++)"ASSIGNED"==e.statusAdditionalAddress[c]&&$(".reboot").addClass("hide");if($(".ips tbody tr:first td.central:first").text().indexOf("Definindo")>=0){var i=$(".ips tbody tr:first td.central:first").html();i=i.replace("Definindo",e.planDetails.ip),$(".ips tbody tr:first td.central:first").html(i),$(".ips tbody tr:first td:last a").attr("rel",e.planDetails.ipId)}""!==e.publicAddressesIp&&(!$(".reiniciar span.ligar-servidor").hasClass("hide")&&$(".reiniciar span.ligar-servidor").size()>=1?a.atualizaIpPublico(e.publicAddresses,e.publicAddressesIp,e.statusAdditionalAddress):a.atualizaIpPublico(e.publicAddresses,e.publicAddressesIp,e.statusAdditionalAddress)),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null}a.errorHandler("#msg-restart-error",f,g,h,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},a.TIME_LATENCY)}a.errorHandler("#msg-restart-error",d,e,f,!1)},a.attachDisk=function(b){$(b).unbind().click(function(b){return b.preventDefault(),$(this).hasClass("disabled")?!1:(tb_show("Conectar Disco","#TB_inline?height=210&width=560&inlineId=attach-detach&modal=false",null),$(".enable-choice").removeClass("hide"),$(".disable-choice").add(".not-machine").addClass("hide"),$("a.connect").attr("rel",$(this).attr("rel")),a.heightModal(),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .connect",".actions:visible .close"),a.getComboDisks(),$(".connect").unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;if($(this).attr("href","#").addClass("disabled"),0===parseInt($("#fieldMachine option:selected").val(),10))return $(".not-machine").removeClass("hide"),$(".connect").removeClass("disabled").attr("href","#"),!1;var c=[];c.push("idtDisk="+$("#fieldMachine option:selected").val()),c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/disks/attach-detach/attach.json",c.join("&"),{method:"POST",fnBeforeSend:a.attachWaiting,fnSuccess:a.attachSuccess,fnError:a.genericCallbackError})}),void $("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal()}))})},a.attachWaiting=function(){a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,["#poweroff-server"]),a.hideAllMessages(),$("#msg-attach-wait").removeClass("hide"),$(".external-disks").not(".hide").addClass("hide"),$(".external-disks.connecting").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)},a.attachSuccess=function(b){var c=b.attach||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=[];g.push("idtDisk="+c.controlRequest),g.push("idtServer="+$(".attach-disk").attr("rel")),a.CONTROL_ATTACH=setInterval(function(){a.ajaxJson("/virtual-machines/disks/attach-detach/get.json",g.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"ATTACHED"==c.disk_status){$(".external-disks").not(".hide").addClass("hide"),$(".external-disks.diskattach").removeClass("hide");var g='<dd id="extdisk-'+c.disk_id+'">'+c.disk_name+" <span>("+c.disk_capacity+') - </span> <a href="#" class="detach-free-disk" rel="'+c.disk_id+'" title="desconectar" alt="desconectar">desconectar</a></dd>';0===$(".external-disks.diskattach dd").not(".button").length?$(".external-disks.diskattach dt").after(g):$(".external-disks.diskattach dd.button").before(g),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),a.detachFreeDisk(".detach-free-disk"),a.hideAllMessages(),$("#msg-attach-ok").removeClass("hide"),c.activeFreeStorageVolumes&&c.storageVolumes?($(".attach-disk").text("Conectar outro"),$(".attach-disk").removeClass("hide"),$(".contract-disk").addClass("hide")):c.activeFreeStorageVolumes&&!c.storageVolumes?($(".attach-disk").text("Conectar disco"),$(".attach-disk").removeClass("hide"),$(".contract-disk").addClass("hide")):($(".attach-disk").addClass("hide"),$(".contract-disk").removeClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.copyHeight(".access",".external-disks"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_ATTACH),delete a.CONTROL_ATTACH}a.errorHandler("#msg-attach-error",d,e,f,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},a.TIME_LATENCY)}a.errorHandler("#msg-attach-error",d,e,f,!1)},a.getComboDisks=function(){var b=["param=false"];a.ajaxJson("/virtual-machines/disks/attach-detach/get-disks.json",b.join("&"),{method:"POST",fnBeforeSend:function(){$("#fieldMachine").attr("disabled","disabled").addClass("inactive"),$("#fieldMachine option").html("Carregando...")},fnSuccess:function(b){var c,d=b.disk||!1,e=b.error||!1,f=b.genericResponse||!1,g=b.sessionStatus||!1;if(d){for($("#fieldMachine option").remove(),$("#fieldMachine").append('<option value="0">Selecione o disco</option>'),c=0;c<b.disk.length;c++)"CONFIRMING_PAYMENT"!=b.disk[c].statusLabel?"INSTALLATION_ERROR"!=b.disk[c].statusLabel&&$("#fieldMachine").append("true"==b.disk[c].disabled?'<option value="'+b.disk[c].id+'" disabled="disabled">'+b.disk[c].name+" - Conectado</option>":'<option value="'+b.disk[c].id+'">'+b.disk[c].name+"</option>"):$("#fieldMachine").append('<option value="'+b.disk[c].id+'" disabled="disabled">'+b.disk[c].name+" - Aguardando confirmação</option>");$("#fieldMachine").removeAttr("disabled").removeClass("inactive"),$("a.connect").removeClass("disabled")}a.errorHandler("#msg-attach-error",e,f,g,!1)},fnError:a.genericCallbackError}),$("#fieldMachine").unbind().change(function(){0!==$(this).val()?$(".not-machine").hasClass("hide")||$(".not-machine").addClass("hide"):$(".not-machine").hasClass("hide")&&$(".not-machine").removeClass("hide")})},a.detachFreeDisk=function(b){$(b).on("click",function(b){return b.preventDefault(),$(this).hasClass("disabled")?!1:(tb_show("Desconectar Disco","#TB_inline?height=210&width=560&inlineId=attach-detach&modal=false",null),$(".disable-choice").removeClass("hide"),$(".enable-choice").addClass("hide"),$("a.disconnect").attr("rel",$(this).attr("rel")),a.heightModal(),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .disconnect",".actions:visible .close"),$("a.disconnect").unbind().click(function(){var b=[];b.push("idtDisk="+$(this).attr("rel")),$("#extdisk-"+$(this).attr("rel")).addClass("disabled"),$(".external-disks dd.item a").unbind(),a.ajaxJson("/virtual-machines/disks/attach-detach/detach.json",b.join("&"),{method:"POST",fnBeforeSend:a.detachFreeDiskWaiting,fnSuccess:a.detachFreeDiskSuccess,fnError:a.genericCallbackError})}),void $("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal()}))})},a.detachFreeDiskWaiting=function(){a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,["#poweroff-server"]),a.hideAllMessages(),$("#msg-detach-wait").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)},a.detachFreeDiskSuccess=function(b){var c=b.detach||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){var g=[];g.push("idtDisk="+c.controlRequest),g.push("idtServer="+$("#fieldvalue").val()),a.CONTROL_DETACH=setInterval(function(){a.ajaxJson("/virtual-machines/disks/attach-detach/get.json",g.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"DETACHED"==c.disk_status&&($("#extdisk-"+c.disk_id).slideUp("slow",function(){$("#extdisk-"+c.disk_id).remove(),a.hideAllMessages(),$("#msg-detach-ok").removeClass("hide"),0===$(".external-disks.diskattach dd").not(".button").length&&($(".external-disks").not(".hide").addClass("hide"),$(".external-disks.diskless").removeClass("hide"))}),c.activeFreeStorageVolumes&&c.storageVolumes?($(".attach-disk").text("Conectar outro"),$(".attach-disk").removeClass("hide"),$(".contract-disk").addClass("hide")):c.activeFreeStorageVolumes&&!c.storageVolumes?($(".attach-disk").text("Conectar disco"),$(".attach-disk").removeClass("hide"),$(".contract-disk").addClass("hide")):($(".attach-disk").addClass("hide"),$(".contract-disk").removeClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.copyHeight(".access",".external-disks"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),clearInterval(a.CONTROL_DETACH)),a.errorHandler("#msg-detach-error",d,e,f,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},a.TIME_LATENCY)}a.errorHandler("#msg-detach-error",d,e,f,!1)},a.powerOff=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/power-off/power_off.json",c.join("&"),{method:"POST",fnBeforeSend:a.powerOffWaiting,fnSuccess:a.powerOffSuccess,fnError:a.genericCallbackError})})},a.powerOffWaiting=function(){tb_show("Desligando...","#TB_inline?height=115&width=450&inlineId=msgWait&modal=true",null),a.heightModal()},a.powerOffSuccess=function(b){var c=b.powerOff||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"true"==c.success&&($("#fieldvalue").val(c.controlRequest),$("#fieldmessage").val("api-stop-success")),d&&"true"==d.exception&&($("#fieldvalue").val(d.controlRequest),$("#fieldmessage").val("api-stop-error")),e&&"fail"==e.request&&($("#fieldvalue").val(e.controlRequest),$("#fieldmessage").val("req-stop-error")),f&&"true"==f.expired?top.location=a.EXPIRED_URL:($("#fieldaction").val("edit-server"),$("form:first").submit())},a.cancelPlan=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:a.cancelPlanSuccess,fnError:a.genericCallbackError})})},a.cancelPlanSuccess=function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"STOPPED"==c.statusLabel&&0===parseInt(c.attachedDisks,10)?($("#manage #fieldaction").val($("#cancel-server").attr("id")),$("#manage #fieldvalue").val($("#cancel-server").attr("rel")),$("#manage").attr("action",$("#cancel-server").attr("rev")).submit()):($(".cancel-choice").children("div").addClass("hide"),tb_show("Atenção","#TB_inline?height=210&width=560&inlineId=cancel-plan&modal=false",null),a.heightModal(),$("a.disconnect-server").add("a.disconnect-disks").attr("rel",c.controlRequest),"RUNNING"==c.statusLabel&&0===parseInt(c.attachedDisks,10)?($(".cancel-disconnect").removeClass("hide"),a.centralizeButtons("#TB_ajaxContent .enable-choice .actions","#TB_ajaxContent",".actions:visible .disconnect-server",".actions:visible .close"),a.disconnect(".disconnect-server","cancel")):"RUNNING"==c.statusLabel&&parseInt(c.attachedDisks,10)>0?($(".cancel-disconnect-all").removeClass("hide"),a.disconnect(".disconnect-server","cancel-all"),a.dispatcherDetachDisks("#msg-cancel-all-ok a")):"STOPPED"==c.statusLabel&&parseInt(c.attachedDisks,10)>0&&($(".cancel-disconnect-disks").removeClass("hide"),a.dispatcherDetachDisks(".disconnect-disks")),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .btn:first",".actions:visible .close"),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(b){b.preventDefault(),tb_remove(),$("#cancel-server").attr("href","#").removeClass("disabled"),a.heightModal()})),a.errorHandler("#msg-updown-error",d,e,f,!1)},a.changeOperatingSystem=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:a.changeOperatingSystemSuccess,fnError:a.genericCallbackError})})},a.changeOperatingSystemSuccess=function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;!c||"STOPPED"!=c.statusLabel&&"SLOT"!=c.statusLabel||0!==parseInt(c.attachedDisks,10)?($(".change-choice").children("div").addClass("hide"),tb_show("Alterar ou reinstalar template","#TB_inline?height=210&width=560&inlineId=change-so&modal=false",null),a.heightModal(),$("a.disconnect-server").add("a.disconnect-disks").attr("rel",c.controlRequest),"RUNNING"==c.statusLabel&&0===parseInt(c.attachedDisks,10)?($(".changeso-disconnect").removeClass("hide"),a.disconnect(".disconnect-server","changeso")):"RUNNING"==c.statusLabel&&parseInt(c.attachedDisks,10)>0?($(".changeso-disconnect-all").removeClass("hide"),a.disconnect(".disconnect-server","changeso-all"),a.dispatcherDetachDisks("#msg-change-so-all-ok a")):"STOPPED"==c.statusLabel&&parseInt(c.attachedDisks,10)>0&&($(".changeso-disconnect-disks").removeClass("hide"),a.dispatcherDetachDisks(".disconnect-disks")),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .btn:first",".actions:visible .close"),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),$("#modify-os").removeClass("disabled"),a.heightModal()})):($("#manage #fieldaction").val($("#modify-os").attr("id")),$("#manage #fieldvalue").val($("#modify-os").attr("rel")),$("#manage").attr("action",$("#modify-os").attr("rev")).submit()),a.errorHandler("#msg-updown-error",d,e,f,!1)},a.acessApp=function(a){$(a).unbind().click(function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return!1;var b=$(this).attr("rel"),c=$.trim($(this).attr("rev")),d=screen.width,e=screen.height,f=d-d/100*20,g=e-e/100*20,h=(e-g)/2,i=(d-f)/2,j="scrollbars=yes,width="+f+",height="+g+",top="+h+",left="+i,k="http://"+b+"/install/"+c;return open(k,"_blank",j,!1),!1})},a.dispatcherDetachDisks=function(b){$(b).unbind().click(function(){var b=[];$("a.detach-free-disk").each(function(){b.push($(this).attr("rel"))});var c=setInterval(function(){if(void 0===a.CONTROL_DETACH&&b.length>0){var d=[];d.push("idtDisk="+b[0]),$("#extdisk-"+b[0]).addClass("disabled"),b.shift(),a.ajaxJson("/virtual-machines/disks/attach-detach/detach.json",d.join("&"),{method:"POST",fnBeforeSend:a.detachFreeDiskWaiting,fnSuccess:a.detachFreeDiskSuccess,fnError:a.genericCallbackError})}else void 0===a.CONTROL_DETACH&&0===b.length&&clearInterval(c)},500)})},a.controlBackupType=function(b){$(b).click(function(){"immediate"!==$(b+":checked").val()?($(".schedule-component").slideDown(),a.createCalendar(".input-scheduling"),$(".form-inputs .lbl-immediate").removeClass("lbl-bold"),$(".form-inputs .lbl-schedule").addClass("lbl-bold")):($(".form-inputs .lbl-immediate").addClass("lbl-bold"),$(".form-inputs .lbl-schedule").removeClass("lbl-bold"),$(".schedule-component").slideUp())})},a.checkDate=function(a,b,c){try{a=parseInt(a,10),b=parseInt(b,10),c=parseInt(c,10)}catch(d){return!1}return 1>a||a>31||1>b||b>12||isNaN(c)||isNaN(b)||isNaN(a)?!1:28>=a?!0:2===b?29===a&&c%4===0&&(c%100!==0||c%400===0):30>=a?!0:4!==b&&6!==b&&9!==b&&11!==b},a.validateCreateBackup=function(b){var c=b,d=0!==$("#TB_ajaxContent #backupName").length?$("#TB_ajaxContent #backupName").val():!1,e=$("#TB_ajaxContent .input-scheduling").val();if(e=e.split("/"),"immediate"===c){if(0===$.trim(d).length)return $("#name-alert").removeClass("hide"),!1}else{if(0===$.trim(d).length&&!a.checkDate(e[0],e[1],e[2]))return $("#TB_ajaxContent #name-alert").removeClass("hide"),$("#TB_ajaxContent #schedule-alert").removeClass("hide"),!1;if(0===$.trim(d).length&&d!==!1)return $("#TB_ajaxContent #name-alert").removeClass("hide"),$("#TB_ajaxContent #schedule-alert").addClass("hide"),!1;if(!a.checkDate(e[0],e[1],e[2]))return $("#TB_ajaxContent #schedule-alert").removeClass("hide"),$("#TB_ajaxContent #name-alert").addClass("hide"),!1}return c},a.resetModalsBackup=function(){$("#TB_ajaxContent .schedule-component").hide(),$("#TB_ajaxContent .input-scheduling").val(""),$("#TB_ajaxContent #name-alert").addClass("hide"),$("#TB_ajaxContent #schedule-alert").addClass("hide"),$("#TB_ajaxContent #check-immediate").attr("checked","checked"),$("#TB_ajaxContent .open-schedule .actual").text("00:00"),$("#TB_ajaxContent .open-recurrence .actual").text("Sem recorrência"),$("#TB_ajaxContent .open-schedule input[name^=data]").val("00:00"),$("#TB_ajaxContent .open-recurrence input[name^=data]").val("ONCE")},a.getToday=function(a){return a.replace(/-/g,"/")},a.createCalendar=function(b){$(b).datepicker({dateFormat:"dd/mm/yy",dayNames:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],dayNamesMin:["DOM","SEG","TER","QUA","QUI","SEX","SAB","DOM"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],nextText:"Próximo",prevText:"Anterior",minDate:a.getToday($(".select-recurrence input[name^=today]").val()),showOn:"button",buttonImage:"/_assets/build/img/ico/calendar-backup.png",buttonImageOnly:!0,buttonText:"Selecione a data inicial",showButtonPanel:!0,currentText:"Hoje"})},a.createBackup=function(b){$(b).live("click",function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=$(this).attr("rel").match(/-?\d/gi),d=$(this).attr("rev").match(/\d/gi),e=[];e.push("idtServer="+c.join("")),a.ajaxJson("/virtual-machines/servers/edit/get.json",e.join("&"),{method:"POST",fnSuccess:function(b){var e=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;e&&($(".create-backup #backupName").add(".create-backup #backupDescription").val(""),a.limitTextarea(".create-backup textarea[maxlength]"),c&&d?(tb_show("Criar backup","#TB_inline?height=450&width=556&inlineId=create-backup&modal=false",null),a.resetModalsBackup(),a.selectPersonalizados("#TB_ajaxContent .open-schedule"),a.selectPersonalizados("#TB_ajaxContent .open-recurrence"),a.heightModal(),$(".form-immediate").addClass("hide"),$(".form-create-backup").removeClass("hide"),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .create",".actions:visible .close"),$("#backupName").focus(),$(".form-inputs .lbl-immediate").addClass("lbl-bold"),$(".form-inputs .lbl-schedule").removeClass("lbl-bold"),$("a.create").unbind().click(function(){var b=$("#TB_ajaxContent .type-backup:checked").val(),e=[],f=$("#TB_ajaxContent .input-scheduling").val().split("/");"immediate"===a.validateCreateBackup(b)?(e.push("idtServer="+c.join("")),e.push("idtSlot="+d.join("")),e.push("nameSlot="+encodeURI(a.validateName($("#backupName").val()))),e.push("descriptionSlot="+encodeURI($.trim($("#backupDescription").val()))),a.ajaxJson("/virtual-machines/servers/edit/backup/create.json",e.join("&"),{method:"POST",fnBeforeSend:a.backupWaiting,fnSuccess:a.createBackupSuccess,fnError:a.genericCallbackError})):"schedule"===a.validateCreateBackup(b)&&(e.push("idtBkp="+d.join("")),e.push("nameSlot="+encodeURI(a.validateName($("#TB_ajaxContent #backupName").val()))),e.push("descriptionSlot="+encodeURI($.trim($("#backupDescription").val()))),e.push("time="+encodeURI($.trim($("#TB_ajaxContent .select-schedule input[name^=data]").val()))),e.push("date="+$("#TB_ajaxContent .input-scheduling").val()),e.push("frequency="+$("#TB_ajaxContent .select-recurrence input[name^=data]").val()),e.push("frequencyText="+encodeURI($.trim($("#TB_ajaxContent .open-recurrence .actual").text()))),e.push("start="+f[2]+f[1]+f[0]),a.ajaxJson("/virtual-machines/servers/edit/backup/configure-scheduling.json",e.join("&"),{method:"POST",fnSuccess:a.createBackupSuccess,fnError:a.genericCallbackError}))})):$(".backup-create").removeClass("disabled"),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),$(".backup-create").removeClass("disabled"),a.heightModal()})),a.errorHandler("#msg-create-backup-error",f,g,h,!1)},fnError:a.genericCallbackError})})},a.backupWaiting=function(){a.disableAllElements(a.MANAGE_SERVER_ELEMENTS)
},a.createBackupSuccess=function(b){var c=b.create||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1,g=b.dateError||!1,h=c.start||!1,i=c.dateFormatted||!1,j=c.frequencyText||!1,k=c.time||!1;c&&"true"===c.success&&(a.hideAllMessages(),h?($(".date-schedule").add(".next-date").text(decodeURIComponent(i)),$(".hour-schedule").add(".next-hour").text(decodeURIComponent(k)),$(".recurrence-schedule em").add(".next-frequency").text(a.urldecode(j)),$(".backupName").html(a.validateName($("#backupName").val())),$(".current .desc cite").html($("#backupDescription").val()),$(".recurrence-schedule").removeClass("hide"),$("#msg-scheduled-backup").removeClass("hide"),$(".creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".backup.current").removeClass("hide"),$(".schedule-component").slideUp(),$(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".last-backup").addClass("hide"),$(".li-update").addClass("hide"),$(".li-restore").addClass("hide"),$(".li-delete").addClass("hide"),$(".li-create").removeClass("hide"),$(".action-try").attr("id","change-scheduling"),$(".action-try").addClass("btn-schedule"),$(".action-try").removeClass("backup-create"),a.urldecode($.trim(j))!==$.trim("Sem recorrência")?$(".recurrence-schedule").removeClass("hide"):$(".recurrence-schedule").addClass("hide"),a.copyHeight(".backup",".load-balancing")):($("#msg-create-backup-queue").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.processing").removeClass("hide"),$(".last-backup").removeClass("hide"),$(".status dt:first").addClass("reload"),$(".form-immediate").addClass("hide"),a.updatePageElements())),a.parentIframeAdjust($("#container")[0].offsetHeight),g&&(a.hideAllMessages(),$("#msg-scheduling-date-error").removeClass("hide"),$(".backup-create").removeClass("disabled")),"immediate"===e.type||"immediate"===d.type?a.errorHandler("#msg-create-backup-error",d,e,f,!1):a.errorHandler("#msg-scheduling-backup-error",d,e,f,!1),a.resetModalsBackup()},a.backupImmediate=function(b){$(b).click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;var c=$(this).attr("rel").match(/-?\d/gi),d=$(this).attr("rev").match(/\d/gi);tb_show("Fazer backup","#TB_inline?height=450&width=639&inlineId=create-backup&modal=false",null),a.resetModalsBackup(),a.heightModal(),$(".form-create-backup").addClass("hide"),$(".schedule-component").hide(),$(".form-immediate").removeClass("hide"),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.create",".actions:visible a.close"),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.create-immediate",".actions:visible a.close"),$(".create-immediate").click(function(){var b=$(".current .desc .backupName").text(),e=$(".desc p cite").text(),f=[];f.push("idtServer="+c.join("")),f.push("idtSlot="+d.join("")),f.push("nameSlot="+encodeURI(a.validateName($.trim(b)))),f.push("descriptionSlot="+encodeURI($.trim(e))),a.ajaxJson("/virtual-machines/servers/edit/backup/create.json",f.join("&"),{method:"POST",fnBeforeSend:a.backupWaiting,fnSuccess:a.createBackupSuccess,fnError:a.genericCallbackError})})})},a.generalScheduling=function(b){$(b).live("click",function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;var c=[],d=$(this).attr("rel").match(/-?\d/gi),e=$(this).attr("rev").match(/\d/gi);return $(this).hasClass("disabled")?!1:("scheduling-now"===$.trim($(this).attr("id"))||"create-scheduling"===$.trim($(this).attr("id"))?(tb_show("Criar agendamento","#TB_inline?height=165&width=540&inlineId=change-schedule&modal=false",null),a.resetModalsBackup(),$("#TB_ajaxContent .schedule-component").show(),$(".general-scheduling").text("Criar")):"change-scheduling"===$.trim($(this).attr("id"))&&(c.push("idtServer="+d.join("")),a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;tb_show("Alterar agendamento","#TB_inline?height=165&width=540&inlineId=change-schedule&modal=false",null),$(".general-scheduling").text("Alterar"),$("#TB_ajaxContent .schedule-component").show(),$("#TB_ajaxContent .input-scheduling").val(c.backupData.nextDate),$("#TB_ajaxContent .open-schedule .actual").text(c.backupData.nextHour),$("#TB_ajaxContent .open-schedule input[name=data-select]").val(c.backupData.nextHour),$("#TB_ajaxContent .open-recurrence .actual").text(c.backupData.frequencyLabel),$(".cloud-skin input[name^=scheduled]").val(c.backupData.isAutoScheduled),$(".select-personalizado ul").slideUp(),a.errorHandler("#msg-scheduling-backup-error",d,e,f,!1)},fnError:a.genericCallbackError})),a.selectPersonalizados("#TB_ajaxContent .open-schedule"),a.selectPersonalizados("#TB_ajaxContent .open-recurrence"),a.createCalendar(".input-scheduling"),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.general-scheduling",".actions:visible a.close"),void $(".general-scheduling").unbind().click(function(){var b=$(".desc strong:first").text(),d=$(".desc p cite").text(),f=$("#TB_ajaxContent .input-scheduling").val().split("/"),g=$("#TB_ajaxContent .open-schedule input[name^=data]").val(),h=$("#TB_ajaxContent .open-recurrence input[name^=data]").val(),i=$("#TB_ajaxContent .open-recurrence .actual").text();return $(this).hasClass("disabled")?!1:void("schedule"===a.validateCreateBackup($(this).attr("rel"))&&(c.push("idtBkp="+e.join("")),c.push("nameSlot="+encodeURI($.trim(b))),c.push("descriptionSlot="+encodeURI($.trim(d))),c.push("time="+encodeURI($.trim(g))),c.push("date="+$("#TB_ajaxContent .input-scheduling").val()),c.push("frequency="+h),c.push("frequencyText="+encodeURI($.trim(i))),c.push("start="+f[2]+f[1]+f[0]),a.ajaxJson("/virtual-machines/servers/edit/backup/configure-scheduling.json",c.join("&"),{method:"POST",fnSuccess:a.generalSchedulingSuccess,fnError:a.genericCallbackError})))}))})},a.generalSchedulingSuccess=function(b){var c=b.create||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1,g=b.dateError||!1,h=c.dateFormatted||!1,i=c.frequencyText||!1,j=c.time||!1,k=$("#TB_ajaxContent input[name^=scheduled]").val();c&&"true"===c.success&&(a.hideAllMessages(),$(".date-schedule").add(".next-date").text(decodeURIComponent(h)),$(".hour-schedule").add(".next-hour").text(decodeURIComponent(j)),$(".recurrence-schedule em").add(".next-frequency").text(a.urldecode($.trim(i))),$(".creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".backup.current").removeClass("hide"),"true"===k?($("#msg-rescheduled-backup").removeClass("hide"),$(".action-try").attr("id","change-scheduling")):($("#msg-scheduled-backup").removeClass("hide"),$(".action-try").attr("id","scheduling-now")),$(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-change .btn-schedule").removeClass("disabled"),$(".li-cancel").removeClass("hide"),a.urldecode($.trim(i))!==$.trim("Sem recorrência")?$(".recurrence-schedule").removeClass("hide"):$(".recurrence-schedule").addClass("hide")),g&&(a.hideAllMessages(),$("#msg-scheduling-date-error").removeClass("hide"),$(".action-try").removeClass("disabled")),a.copyHeight(".backup",".load-balancing"),a.resetModalsBackup(),a.errorHandler("#msg-scheduling-backup-error",d,e,f,!1)},a.cancelScheduling=function(b){$(b).on("click",function(b){return b.preventDefault(),$(this).hasClass("disabled")?!1:(tb_show("Cancelar agendamento","#TB_inline?height=215&width=415&inlineId=backup-cancel-scheduling&modal=false",null),void a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.cancel-scheduling",".actions:visible a.close"))}),$("a.cancel-scheduling").on("click",function(b){b.preventDefault();var c=[];c.push("idtbackup="+$(this).attr("rev")),a.ajaxJson("/virtual-machines/servers/edit/backup/cancel-scheduling.json",c.join("&"),{method:"POST",fnSuccess:function(b){var c=b.clearAutoScheduling||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1,g=$(".cloud-skin input[name^=free]").val();c.success&&(a.hideAllMessages(),$("#msg-cancel-scheduling").removeClass("hide"),"true"===g?($(".backup.current").removeClass("hide"),$(".backup-schedule").removeClass("hide"),$(".creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".auto-scheduled").addClass("hide")):($(".creating").removeClass("hide"),$(".backup-create").removeClass("disabled"),$(".backup-schedule").addClass("hide"),$(".backup.current").addClass("hide"),$(".backup.processing").addClass("hide"),$(".auto-scheduled").addClass("hide")),$(".action-try").attr("id","scheduling-now"),$(".li-cancel").addClass("hide"),$(".li-change").addClass("hide"),$(".li-schedule").removeClass("hide")),a.errorHandler("#msg-cancel-scheduling-error",d,e,f,!1)},fnError:a.genericCallbackError}),a.copyHeight(".backup",".load-balancing")})},a.showBackupInfo=function(b){$(b).unbind().click(function(b){b.preventDefault();var c=[],d=$(this).attr("rel");return $(this).hasClass("disabled")?!1:(c.push("idtServer="+d),void a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1,g=c.backupData||!1;c&&g&&(tb_show("Editar dados","#TB_inline?height=210&width=390&inlineId=update-info&modal=false",null),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .edit",".actions:visible .close"),$("#TB_ajaxContent #editName").val(a.htmlDecode(g.name)),$("#TB_ajaxContent #editDescription").val(a.htmlDecode(a.urldecode($.trim(g.description)))),a.genericFormValidator(".form-update-info input",".form-update-info textarea"),$(".form-update-info").submit(function(a){a.preventDefault()})),a.errorHandler("#msg-update-error",d,e,f,!1)},fnError:a.genericCallbackError}))}),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal(),$(".btn.edit").removeClass("disabled")})},a.updateBackupInfo=function(b){a.sendFormByReturn($("#editName"),$(b)),$(b).unbind().click(function(b){b.preventDefault();var c=[],d=$(this).attr("rel"),e=$("#TB_ajaxContent #editName").val(),f=$("#TB_ajaxContent #editDescription").val();return $(this).hasClass("disabled")?!1:(c.push("idtBackup="+d),c.push("name="+encodeURI(a.validateName(e))),c.push("description="+encodeURI($.trim(f))),void a.ajaxJson("/virtual-machines/servers/edit/backup/update-info.json",c.join("&"),{method:"POST",fnSuccess:function(b){var c=b.update||!1,d=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;c&&(a.hideAllMessages(),$(".backupName").text(a.urldecode(a.validateName(e))),$(".current .desc. p > cite").text(a.urldecode(f)),$("#msg-update-info").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight)),a.errorHandler("#msg-update-error",d,g,h,!1)},fnError:a.genericCallbackError}))})},a.updateBackup=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=$(this).attr("rel").match(/-?\d/gi),d=$(this).attr("rev").match(/\d/gi),e=[];e.push("idtServer="+c.join("")),a.ajaxJson("/virtual-machines/servers/edit/get.json",e.join("&"),{method:"POST",fnSuccess:function(b){var e=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;if(e){if($(".update-backup input").add(".update-backup textarea").val(""),a.limitTextarea(".update-backup textarea[maxlength]"),c&&d){tb_show("Refazer backup","#TB_inline?height=165&width=405&inlineId=update-backup&modal=false",null),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.update",".actions:visible a.close"),a.heightModal(),$("#TB_ajaxContent .serverName").html($("span.servername:first").text());var i="#backup-"+d.join("")+" ",j=$("dd.desc .backupName").text(),k=$("dd.desc p cite:first").text();$("#backupUpdateName").val(j),$("#backupUpdateDescription").val(k),$(".update-backup .backupName").html($(i+"dd.item").html()),$(".update-backup .backupDate").html($(i+"dd.createat span").html()),$("#backupUpdateName").focus(),$("a.update").unbind().click(function(){var b=[];b.push("idtServer="+c.join("")),b.push("idtSlot="+d.join("")),b.push("nameSlot="+encodeURI($.trim($("#backupUpdateName").val()))),b.push("descriptionSlot="+encodeURI($.trim($("#backupUpdateDescription").val()))),a.ajaxJson("/virtual-machines/servers/edit/backup/update.json",b.join("&"),{method:"POST",fnBeforeSend:a.backupWaiting,fnSuccess:a.updateBackupSuccess,fnError:a.genericCallbackError})})}else $(".backup-update").removeClass("disabled");$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),$(".backup-update").removeClass("disabled"),a.heightModal()})}a.errorHandler("#msg-update-backup-error",f,g,h,!1)},fnError:a.genericCallbackError})})},a.updateBackupSuccess=function(b){var c=b.update||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"true"==c.success&&(a.hideAllMessages(),$("#msg-update-backup-queue").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.processing").removeClass("hide"),$(".status dt:first").addClass("reload"),a.updatePageElements()),a.errorHandler("#msg-update-backup-error",d,e,f,!1)},a.restoreBackup=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=$(this).attr("rel").match(/-?\d/gi),d=$(this).attr("rev").match(/\d/gi),e=$(this).attr("class").split(" ")[0],f=[];f.push("idtServer="+c.join("")),a.ajaxJson("/virtual-machines/servers/edit/get.json",f.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,f=b.error||!1,g=b.genericResponse||!1,h=b.sessionStatus||!1;if(c.attachedDisks>0)a.forbiddenBackup("Restaurar backup",e),$(".form-create-backup").addClass("hide"),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.close");else{if(d){var i=[];i.push("idtSlot="+d.join("")),tb_show("Restaurar backup","#TB_inline?height=185&width=435&inlineId=restore-backup&modal=false",null),a.heightModal(),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.restore",".actions:visible a.close");var j="#backup-"+d.join("")+" ";$(".serverName").html($("span.servername:first").html()),$(".restore-backup .backupDate").html($(j+"dd.createat span").html()),$(".restore").unbind().click(function(){a.ajaxJson("/virtual-machines/servers/edit/backup/restore.json",i.join("&"),{method:"POST",fnBeforeSend:a.backupWaiting,fnSuccess:a.restoreBackupSuccess,fnError:a.genericCallbackError})})}$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),$(".backup-restore").removeClass("disabled"),a.heightModal()})}a.errorHandler("#msg-restore-backup-error",f,g,h,!1)},fnError:a.genericCallbackError})})},a.restoreBackupSuccess=function(b){var c=b.restore||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"true"==c.success&&(a.hideAllMessages(),$("#msg-restore-backup-wait").removeClass("hide"),$("#msg-restore-backup-wait .backupName").html($(".current .desc .backupName").text()),$(".backup").not(".hide").addClass("hide"),$(".backup.processing").removeClass("hide"),$(".status dt:first").addClass("reload"),a.updatePageElements()),a.errorHandler("#msg-restore-backup-error",d,e,f,!1)},a.deleteBackup=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=$(this).attr("rel").match(/\d/gi);if(c){var d=[];d.push("idtSlot="+c.join(""));var e="#backup-"+c.join("")+" ";tb_show("Excluir backup","#TB_inline?height=185&width=400&inlineId=delete-backup&modal=false",null),a.centralizeButtons("#TB_ajaxContent .actions:visible","#TB_ajaxContent",".actions:visible a.delete",".actions:visible a.close"),$("strong.serverName").html($("span.servername:first").html()),$("strong.backupName").html($(".backup.current strong:first").text()),$("strong.backupDate").html($(e+"dd.current span").html()),$("a.delete").unbind().click(function(){a.ajaxJson("/virtual-machines/servers/edit/backup/delete.json",d.join("&"),{method:"POST",fnBeforeSend:a.backupWaiting,fnSuccess:a.deleteBackupSuccess,fnError:a.genericCallbackError})}),a.heightModal()}$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),$(".backup-delete").removeClass("disabled"),a.heightModal()})})},a.deleteBackupSuccess=function(b){var c=b.free||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"true"==c.success&&(a.hideAllMessages(),$("#msg-delete-backup-wait .backupName").html($(".backup.current .desc .backupName").text()),$("#msg-delete-backup-wait").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.processing").removeClass("hide"),$(".status dt:first").addClass("reload"),a.updatePageElements()),a.errorHandler("#msg-delete-backup-error",d,e,f,!1)},a.forbiddenBackup=function(b,c){tb_show(b,"#TB_inline?height=210&width=560&inlineId=create-backup&modal=false",null),"backup-restore"==c&&$(".detach-backup-restore").removeClass("hide"),a.heightModal(),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal(),$("."+c).removeClass("disabled"),$(".detach-backup-restore").addClass("hide")})},a.abortBackup=function(b,c){$(b).add(c).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled"),$(".status dd:first").removeClass("reload"),a.FLOW_ACTION=parseInt($(this).attr("rev"),10);var c=$(this).attr("rel").match(/\d/gi);if(c){var d=[];d.push("idtSlot="+c.join("")),a.ajaxJson("/virtual-machines/servers/edit/backup/abort.json",d.join("&"),{method:"POST",fnBeforeSend:a.abortBackupWaiting,fnSuccess:a.abortBackupSuccess,fnError:a.genericCallbackError})}})},a.abortBackupWaiting=function(){clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null},a.abortBackupSuccess=function(b){var c=b.abort||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;if(c&&"true"==c.success){a.hideAllMessages(),0===a.FLOW_ACTION?($("#msg-abort-backup-wait").removeClass("hide"),$(".status dd:first").html("Cancelando backup")):($("#msg-abort-backup-update-wait").removeClass("hide"),$(".status dd:first").html("Cancelando"));var g="#backup-"+c.controlRequest+" ";$(g+"dd.item").html("Cancelando"),setTimeout(function(){0===a.FLOW_ACTION?($(g+"dd.item").html("Nenhum").addClass("not-item").removeClass("item"),$(g+"dd:last").after('<dd class="button"><a href="#" class="btn backup-create disabled" rel="'+$("#restart-server").attr("rel")+'" rev="'+c.controlRequest+'">Fazer backup</a></dd>'),a.createBackup(".backup-create")):setTimeout(function(){$(g+"dd.item").html($(g+"dd.item").attr("rev")),$(g+"dd.detail").removeClass("hide")},1e3),setTimeout(function(){var b=["idtServer="+$("#fieldvalue").val()];a.ajaxJson("/virtual-machines/servers/edit/get.json",b.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&(a.hideAllMessages(),0===a.FLOW_ACTION?$("#msg-abort-backup-ok").removeClass("hide"):$("#msg-abort-backup-update-ok").removeClass("hide"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),$("dl.status dd:first").html(c.statusDescription),"UNUSED"===c.backupData.statusLabel&&"false"===c.backupData.isAutoScheduled?($(".backup.creating").removeClass("hide"),$(".backup.processing").addClass("hide"),$(".backup.current").addClass("hide")):"UNUSED"!==c.backupData.statusLabel&&"false"===c.backupData.isAutoScheduled?($(".backup.current").removeClass("hide"),$(".last-backup").removeClass("hide"),$(".backup-schedule").removeClass("hide"),$(".backup.creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".auto-scheduled").addClass("hide"),$(".li-create").addClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),$(".li-schedule").removeClass("hide")):"UNUSED"!==c.backupData.statusLabel&&"true"===c.backupData.isAutoScheduled?($(".backup.current").removeClass("hide"),$(".last-backup").removeClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".backup.creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".backup-schedule").addClass("hide"),$(".li-create").addClass("hide"),$(".li-schedule").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide")):($(".last-backup").addClass("hide"),$(".backup.creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".backup-schedule").addClass("hide"),$(".backup.current").removeClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".li-schedule").addClass("hide"),$(".li-update").addClass("hide"),$(".li-restore").addClass("hide"),$(".li-delete").addClass("hide"),$(".li-create").removeClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide")),"STOPPED"==c.statusLabel&&($("#disconnect-server").addClass("hide"),$("#connect-server").removeClass("hide")),$("a.abort-update").add("a.abort-backup").removeClass("disabled")),a.errorHandler("#msg-abort-backup-error",d,e,f,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},1e3)},a.TIME_LATENCY)}a.errorHandler("#msg-abort-backup-error",d,e,f,!1)},a.backupTips=function(b){$(b).click(function(){tb_show("Protegendo seus dados","#TB_inline?height=210&width=488&inlineId=backup-tips&modal=false",null),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .close")})},a.acknowledgeBackup=function(b,c){var d=[];d.push("idtSlot="+b),d.push("typeAction="+c),a.ajaxJson("/virtual-machines/servers/edit/backup/ack.json",d.join("&"),{method:"POST",fnSuccess:function(b){var c=b.ack||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;"true"==c.success&&setTimeout(function(){var b=[];b.push("idtServer="+$("#fieldvalue").val()),a.ajaxJson("/virtual-machines/servers/edit/get.json",b.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&(a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),$("dl.status dd:first").html(c.statusDescription),a.parentIframeAdjust($("#container")[0].offsetHeight),$(".cloud-skin input[name^=free]").val(c.backupData.free),"STOPPED"==c.statusLabel&&($("#disconnect-server").addClass("hide"),$("#connect-server").removeClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"))),a.errorHandler(".exception",d,e,f,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError})},1e3),a.errorHandler(".exception",d,e,f,a.CONTROL_INTERVAL)},fnError:a.genericCallbackError}),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null},a.upgradeOrDowngrade=function(b){$(b).unbind().click(function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;$(this).attr("href","#").addClass("disabled");var c=[];c.push("idtServer="+$(this).attr("rel")),a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:a.upgradeOrDowngradeSuccess,fnError:a.genericCallbackError})})},a.upgradeOrDowngradeSuccess=function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;c&&"STOPPED"==c.statusLabel?($("#manage #fieldaction").val($(".up-down-grade").data("action")),$("#manage #fieldvalue").val($(".up-down-grade").attr("rel")),$("#manage").attr("action",$(".up-down-grade").attr("rev")).submit()):(tb_show("Atenção","#TB_inline?height=210&width=560&inlineId=upgrade-downgrade&modal=false",null),$(".upgrade-choice").removeClass("hide"),$("a.disconnect-server").attr("rel",c.controlRequest),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .disconnect-server",".actions:visible .close"),a.disconnect(".disconnect-server","upgradedowngrade"),a.heightModal(),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal(),$(".up-down-grade").removeClass("disabled")})),a.errorHandler("#msg-updown-error",d,e,f,!1)},a.upgradeOrDowngradeProcess=function(b,c){var d=a.APP_PATH+"/virtual-machines/servers/swap-plan/feedback/?instance="+c,e=d+"&return=error",f=d+"&return=success";self.location=b===!1?e:f},a.updatePageElements=function(){if($(".reload").size()>0){var b=[];b.push("idtServer="+$("#fieldvalue").val()),a.ajaxJson("/virtual-machines/servers/edit/get.json",b.join("&"),{method:"POST",fnSuccess:a.updatePageElementsSuccess,fnError:a.genericCallbackError}),a.CONTROL_INTERVAL=setInterval(function(){a.ajaxJson("/virtual-machines/servers/edit/get.json",b.join("&"),{method:"POST",fnSuccess:a.updatePageElementsSuccess,fnError:a.genericCallbackError})},a.TIME_LATENCY)}},a.updatePageElementsSuccess=function(b){var c=b.get||!1,d=b.error||!1,e=b.genericResponse||!1,f=b.sessionStatus||!1;$("dl.status dd:first").html(c.statusDescription),c&&(a.LAST_MESSAGE=a.hideAllMessages(),$("#rebootIp").addClass("hide"),"RECONFIGURING"==c.statusLabel&&$("#msg-updown-info-callback").removeClass("hide"),"INSTALLING"==c.statusLabel&&($("#msg-installing-wait").removeClass("hide"),$(".contract-ip").addClass("disabled"),$(".backup-delete").addClass("disabled"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"UNINSTALLING"==c.statusLabel&&($("#msg-uninstalling-wait").removeClass("hide"),$(".contract-ip").addClass("disabled"),$(".backup-delete").addClass("disabled"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"REBOOTING"==c.statusLabel&&($("dl.status dd").eq(0).html("Reiniciando"),$("#msg-restart-wait").removeClass("hide"),a.LAST_STATUS="REBOOTING",$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),"true"==c.rebootPrivate&&($(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reiniciar span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reiniciar span.ligar-servidor")),"true"==c.rebootPublicIp&&($(".reboot span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reboot span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reboot span.ligar-servidor")),$(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaIpPrivado(c.privateAddresses,".reiniciar span.reiniciar-servidor"):a.atualizaIpPrivado(c.privateAddresses,".reiniciar span.ligar-servidor")),"STARTING"==c.statusLabel&&($(".backup-delete").removeClass("disabled"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),"REBOOTING"==a.LAST_STATUS?($("dl.status dd").eq(0).html("Reiniciando"),$("#msg-restart-wait").removeClass("hide")):($("#msg-connect-wait").removeClass("hide"),a.LAST_STATUS="STARTING"),"true"==c.rebootPrivate&&($(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaLabelIp("Definindo",".reiniciar span.reiniciar-servidor"):a.atualizaLabelIp("Definindo",".reiniciar span.ligar-servidor")),$(".reiniciar span.ligar-servidor").hasClass("hide")?a.atualizaIpPrivado(c.privateAddresses,".reiniciar span.reiniciar-servidor"):a.atualizaIpPrivado(c.privateAddresses,".reiniciar span.ligar-servidor")),"STOPPING"==c.statusLabel&&($("#msg-disconnect-wait").removeClass("hide"),$(".backup-delete").removeClass("disabled"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"BACKUP_REQUESTED"==c.statusLabel&&($("#msg-create-backup-queue").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"BACKING_UP"==c.statusLabel&&($("#msg-create-backup-wait").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"BACKUP_COMPLETED"==c.statusLabel&&($("#msg-create-backup-ok strong").html(c.backupData.name),$("#msg-create-backup-ok").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup.current dd.desc").find("strong.backupName").html(c.backupData.name),$(".backup.current dd.desc").find("p cite:first").html(a.urldecode(c.backupData.description)),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".auto-scheduled").addClass("hide"),$(".backup-schedule").removeClass("hide")),$(".action-try").attr("id","change-scheduling"),$(".action-try").addClass("btn-schedule"),$(".action-try").removeClass("backup-create"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".cloud-skin input[name^=scheduled]").val(c.backupData.isAutoScheduled),a.copyHeight(".backup",".load-balancing"),a.acknowledgeBackup(c.backupData.id,"backup")),"BACKUP_FAILED"==c.statusLabel&&($("#msg-create-backup-error").removeClass("hide"),$("dl.status dd:first").html(c.statusDescription),$(".backup").not(".hide").addClass("hide"),$(".backup.creating").removeClass("hide"),$(".backup.current .desc").find("strong.backupName").html(c.backupData.name).find("p cite").html(c.backupData.description),"true"===c.backupData.isAutoScheduled?($(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".auto-scheduled").addClass("hide"),$(".backup-schedule").removeClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),a.acknowledgeBackup(c.backupData.id,"backup")),"FREEING"==c.statusLabel&&($("#msg-delete-backup-wait").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight)),"FREE_COMPLETED"==c.statusLabel&&($("#msg-delete-backup-ok .backupName").html($(".current .desc .backupName").text()),$("#msg-delete-backup-ok").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.creating").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".backup.creating").addClass("hide"),$(".backup.processing").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".last-backup").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".li-schedule").addClass("hide"),$(".li-create").removeClass("hide"),$(".li-update").addClass("hide"),$(".li-restore").addClass("hide"),$(".li-delete").addClass("hide"),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),$(".next-frequency").html(c.backupData.frequencyLabel),$(".action-try").addClass("btn-schedule"),$(".action-try").removeClass("backup-create")):($(".backup.creating").removeClass("hide"),$(".backup.processing").addClass("hide"),$(".backup.current").addClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".li-schedule").removeClass("hide"),$(".action-try").removeClass("btn-schedule"),$(".action-try").addClass("backup-create")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".cloud-skin input[name^=scheduled]").val(c.backupData.isAutoScheduled),a.copyHeight(".backup",".load-balancing"),a.acknowledgeBackup(c.backupData.id,"backup")),"FREE_FAILED"==c.statusLabel&&($("#msg-delete-backup-error").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup.current .desc").find("strong.backupName").html(c.backupData.name).find("p cite").html(c.backupData.description),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".auto-scheduled").addClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),a.acknowledgeBackup(c.backupData.id,"backup")),"REPLACE_BACKUP_REQUESTED"==c.statusLabel&&($("#msg-update-backup-queue").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight)),"REPLACE_BACKING_UP"==c.statusLabel&&($("#msg-update-backup-wait").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight)),"REPLACE_BACKUP_COMPLETED"==c.statusLabel&&($("#msg-update-backup-ok strong").html(c.backupData.name),$("#msg-update-backup-ok").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup.current .desc").find("strong.backupName").html(c.backupData.name).find("p cite").html(c.backupData.description),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".auto-scheduled").addClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".cloud-skin input[name^=scheduled]").val(c.backupData.isAutoScheduled),a.acknowledgeBackup(c.backupData.id,"backup")),"REPLACE_BACKUP_FAILED"==c.statusLabel&&($("#msg-update-backup-error .backupName").html(c.backupData.name),$("#msg-update-backup-error").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup.current .desc").find("strong.backupName").html(c.backupData.name).find("p cite").html(c.backupData.description),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".auto-scheduled").addClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),a.acknowledgeBackup(c.backupData.id,"backup")),"RESTORING"==c.statusLabel&&($("#msg-restore-backup-wait").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled")),"RESTORE_COMPLETED"==c.statusLabel&&($("#msg-restore-backup-ok .backupName").html(c.backupData.name),$("#msg-restore-backup-ok").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide"),$(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),$(".next-frequency").html(c.backupData.frequencyLabel),"ONCE"!==c.backupData.frequencyValue?$(".next-frequency").removeClass("hide"):$(".next-frequency").addClass("hide")):($(".auto-scheduled").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".li-schedule").removeClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.copyHeight(".backup",".load-balancing"),a.acknowledgeBackup(c.backupData.id,"backup")),"RESTORE_FAILED"==c.statusLabel&&($("#msg-restore-backup-error .backupName").html(c.backupData.name),$("#msg-restore-backup-error").removeClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".auto-scheduled").addClass("hide")),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.acknowledgeBackup(c.backupData.id,"backup")),("TEMPLATING_UP"===c.statusLabel||"TEMPLATE_REQUESTED"===c.statusLabel)&&($("#msg-create-template-wait").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight)),"TEMPLATE_COMPLETED"===c.statusLabel&&($("#msg-create-template-ok").removeClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight),a.acknowledgeBackup(c.instanceId,"template")),"TEMPLATE_FAILED"===c.statusLabel&&($("#msg-create-template-error").removeClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight),a.acknowledgeBackup(c.instanceId,"template")),"SERVER_INSTALLING"===c.statusLabel&&($("#msg-installing-template").removeClass("hide"),$("#create-scheduling").addClass("disabled"),$("#change-scheduling").addClass("disabled"),$(".cancel-request").addClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight)),"SERVER_INSTALL_COMPLETED"===c.statusLabel&&($("#msg-installed-template").removeClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight),a.acknowledgeBackup(c.instanceId,"template")),a.parentIframeAdjust($("#container")[0].offsetHeight),a.copyHeight(".status",".system-installed",".access",".external-disks",".backup",".load-balancing"));
var g,h,i=["21d7246b-c192-406c-8fca-eb89a70ada4d","21d7246b-c192-406c-8fca-eb89a70ada4f","21d7246b-c192-406c-8fca-eb89a70ada50","21d7246b-c192-406c-8fca-eb89a70ada51","21d7246b-c192-406c-8fca-eb89a70ada52","21d7246b-c192-406c-8fca-eb89a70ada53","21d7246b-c192-406c-8fca-eb89a70ada54"],j=['<span class="centos" title="">CentOS <cite>- 32 bits</cite></span>','<span class="ubuntu" title="">Ubuntu <cite>- 32 bits</cite></span>','<span class="ubuntu" title="">Ubuntu <cite>- 64 bits</cite></span>','<span class="win" title="">Win 2003 <cite>- 32 bits</cite></span>','<span class="win" title="">Win 2003 <cite>- 64 bits</cite></span>','<span class="win" title="">Win 2008 <cite>- 32 bits</cite></span>','<span class="win" title="">Win 2008 <cite>- 64 bits</cite></span>'];for(g in i)i[g]==c.image&&($("dl.system-installed dd").eq(0).html(j[g]),$("dl.system-installed dd span").attr("title",c.imageDescription));c&&"STOPPED"==c.statusLabel&&($("dl.status dd").eq(0).html("Desligado"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),a.hideAllMessages(),"STOPR"==c.status?(parseInt(c.planNumber,10)<parseInt($("#planName").attr("rel"),10)?$("#msg-down-ok-callback").removeClass("hide"):$("#msg-up-ok-callback").removeClass("hide"),$(".ips tbody tr:first td.central:first").text().indexOf("Definindo")>=0&&(h=$(".ips tbody tr:first td.central:first").html(),h=h.replace("Definindo",c.planDetails.ip),$(".ips tbody tr:first td.central:first").html(h),$(".ips tbody tr:first td:last a").attr("rel",c.planDetails.ipId)),$("#planName").attr("rel",c.planNumber).html(c.planName),$("#createAt").html(c.planDetails.createdAt),$("#memory").html(c.planDetails.memory),$("#cpu").html(c.planDetails.processor),$("#disk").html(c.planDetails.storage),$("#io").html(c.planDetails.io),$("#band").html(c.planDetails.bandwidth),$("#ip").html(c.planDetails.ip)):$("#msg-disconnect-ok").removeClass("hide"),$("div.reboot").hasClass("hide")||$("div.reboot").addClass("hide"),$(".backup").not(".hide").addClass("hide"),$(".backup.current").removeClass("hide"),$(".backup.current .desc").find("strong.backupName").html(c.backupData.name).find("p cite").html(c.backupData.description),$(".created-date").html(c.backupData.date),$(".created-hour").html(c.backupData.hour),$(".li-create").addClass("hide"),$(".li-update").removeClass("hide"),$(".li-restore").removeClass("hide"),$(".li-delete").removeClass("hide"),"true"===c.backupData.isAutoScheduled?($(".li-schedule").addClass("hide"),$(".li-change").removeClass("hide"),$(".li-cancel").removeClass("hide"),$(".backup-schedule").addClass("hide"),$(".auto-scheduled").removeClass("hide")):($(".li-schedule").removeClass("hide"),$(".li-change").addClass("hide"),$(".li-cancel").addClass("hide"),$(".backup-schedule").removeClass("hide"),$(".auto-scheduled").addClass("hide")),$(".cloud-skin input[name^=scheduled]").val(c.backupData.isAutoScheduled),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$("#disconnect-server").addClass("hide"),$("#connect-server").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null),c&&"RUNNING"==c.statusLabel&&($("dl.status dd").eq(0).html("Ligado"),a.enableAllElements(a.MANAGE_SERVER_ELEMENTS,[],a.MANAGE_SERVER_FLAGS,c),a.LAST_MESSAGE=a.hideAllMessages(),$(".ips tbody tr:first td.central:first").text().indexOf("Definindo")>=0&&(h=$(".ips tbody tr:first td.central:first").html(),h=h.replace("Definindo",c.planDetails.ip),$(".ips tbody tr:first td.central:first").html(h),$(".ips tbody tr:first td:last a").attr("rel",c.planDetails.ipId)),$(".ips tbody tr:first td.central:first").text().indexOf("Definindo")>=0&&(h=$(".ips tbody tr:first td.central:first").html(),h=h.replace("Definindo",c.planDetails.ip),$(".ips tbody tr:first td.central:first").html(h),$(".ips tbody tr:first td:last a").attr("rel",c.planDetails.ipId)),""!==c.publicAddressesIp&&($(".ligar-servidor").hasClass("hide")?a.atualizaIpPublico(c.publicAddresses,c.publicAddressesIp,c.statusAdditionalAddress):a.atualizaIpPublico(c.publicAddresses,c.publicAddressesIp,c.statusAdditionalAddress)),"msg-installing-wait"==a.LAST_MESSAGE?$("#msg-installing-ok").removeClass("hide"):"REBOOTING"==a.LAST_STATUS?$("#msg-restart-ok").removeClass("hide"):$("#msg-connect-ok").removeClass("hide"),$("div.reboot").hasClass("hide")||$("div.reboot").addClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),$("#connect-server").addClass("hide"),$("#disconnect-server").removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null),c&&"DEPLOY_MIGRATING"==c.statusLabel&&(a.disableAllElements(a.MANAGE_SERVER_ELEMENTS,a.MANAGE_SERVER_FLAGS),$("#msg-deploy-ok").removeClass("hide"),$("#create-scheduling").removeClass("disabled"),$("#change-scheduling").removeClass("disabled"),$(".cancel-request").removeClass("disabled"),a.parentIframeAdjust($("#container")[0].offsetHeight),clearInterval(a.CONTROL_INTERVAL),a.CONTROL_INTERVAL=null),a.errorHandler("#msg-connect-error",d,e,f,a.CONTROL_INTERVAL)},a.choiceNewPlan=function(){$(".downgrade").add(".upgrade").add(".bt-plan").click(function(a){return a.preventDefault(),$(this).hasClass("disabled")?!1:($(this).attr("href","#").addClass("disabled"),$("#fieldaction").attr("value","confirmation"),$("#fieldvalue").attr("value",$(this).attr("rel")),$("#fieldmessage").attr("value",$(this).attr("rev")),void $("#manage").submit())})},a.agreeTerms=function(a,b,c){$(a).unbind().click(function(){"checked"==$(this).attr("checked")?$(b).removeClass(c):$(b).addClass(c)})},a.showTermsOfUse=function(b,c){$(b).toggle(function(){return $(c).removeClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),!1},function(){return $(c).addClass("hide"),a.parentIframeAdjust($("#container")[0].offsetHeight),!1})},a.confirmUpgradeDowngrade=function(){$(".upgrade").add(".downgrade").unbind().click(function(){1==$("#fieldagree:checked").length&&(tb_show("Processando","#TB_inline?height=115&width=450&inlineId=msgWait&modal=true",null),a.heightModal(),$("#product_id").size()>=1?($("#manage").attr("action","/virtual-machines/servers/swap-plan/feedback/"),$("#manage").submit()):($("form").attr("action",$("form").attr("action")+$("input[name=code_swap]").val()),$("#changeplan").submit()))})},a.showPassword=function(b){$(b).click(function(b){b.preventDefault();var c=$(this);c.next().text(c.attr("rel")),c.hide(),a.CONTROL_TIME_OUT=setTimeout(function(){c.show().next().text(""),clearTimeout(a.CONTROL_TIME_OUT)},a.TIME_LATENCY)})},a.disableAllElements=function(b,c){var d;for(d in b)a.inArray(c,b[d])||($(b[d]).attr("href","#").addClass("disabled"),$(b[d]).parents(".item").addClass("disabled"))},a.enableAllElements=function(b,c,d,e){var f,g;for(f in b)a.inArray(c,b[f])===!1&&"true"==e[d[f]]?($(b[f]).attr("href","#").removeClass("disabled"),$(b[f]).parents(".item").removeClass("disabled")):(g=d[f].split("."),g.length>=2?"true"==e[g[0]][g[1]]&&$(b[f]).attr("href","#").removeClass("disabled"):($(b[f]).attr("href","#").addClass("disabled"),$(b[f]).parents(".item").addClass("disabled")))},a.plotDonuts=function(){var b=["idtServer="+$("#fieldvalue").val()];a.ajaxJson("/virtual-machines/servers/edit/donuts.json",b.join("&"),{method:"POST",fnSuccess:a.plotDonutsSuccess,fnError:a.genericCallbackError})},a.plotDonutsSuccess=function(b){var c=b.cpu||!1,d=b.net||!1,e=b.io||!1;c&&(a.plotDonut("donut_cpu",parseFloat(c.used),parseFloat(c.free),c.level),c.alert===!0&&a.donutAlert("#donut_cpu","cpu",parseFloat(c.currentValue)),"NOTHING"!==c.level&&$("#donut_cpu").parent().find(".counter b").html(c.used.toString().replace(".",","))),d&&(a.plotDonut("donut_trafego",parseFloat(d.used),parseFloat(d.free),d.level),d.alert===!0&&a.donutAlert("#donut_trafego","trafego",parseFloat(d.currentValue)),"NOTHING"!==d.level&&$("#donut_trafego").parent().find(".counter b").html(d.currentValue.toString().replace(".",","))),e&&(a.plotDonut("donut_disco",parseFloat(e.used),parseFloat(e.free),e.level),e.alert===!0&&a.donutAlert("#donut_disco","io",parseFloat(e.currentValue)),"NOTHING"!==e.level&&$("#donut_disco").parent().find(".counter b").html(e.used.toString().replace(".",",")))},a.donutAlert=function(a,b,c){var d;$(a).parent().addClass("alert"),c=c.toString().replace(".",","),"cpu"===b?d="<b>Atenção:</b> Você está utilizando "+c+"% da capacidade de processamento do servidor (CPU).":"trafego"===b?d="<b>Atenção:</b> Sua máquina está com intenso tráfego de rede ("+c+"Mb/s).":"io"===b&&(d="<b>Atenção:</b> Você está utilizando "+c+"% da capacidade de operações do disco (I/O)."),$(a).parent().qtip({content:d,position:{corner:{target:"topMiddle",tooltip:"bottomMiddle"}},style:{background:"#fff2b8",color:"#464646",fontSize:13,fontFamily:"arial",border:{width:1,radius:6,color:"#fff2b8"},padding:0,textAlign:"left",width:215,tip:!0,name:"cream"}})},a.plotDonut=function(a,b,c,d){var e=["#3ea201","#f3ae1a","#e05024","#CCC","rgba(255, 255, 255, 0)"],f=[];f="NOTHING"===d?[{color:e[3],drilldown:{categories:"Erro",data:"100"}}]:[{color:"OK"===d?e[0]:"WARNING"===d?e[1]:"CRITICAL"===d?e[2]:e[3],drilldown:{categories:"Usado",data:100>b?b:100}},{color:e[4],drilldown:{categories:"Livre",data:c>0?c:0}}];var g,h,i=[];for(g=0,h=f.length;h>g;g++)i.push({name:f[g].drilldown.categories,y:f[g].drilldown.data,color:Highcharts.Color(f[g].color).brighten(0).get()});var j=new Highcharts.Chart({chart:{renderTo:a,plotBackgroundColor:e[4],backgroundColor:e[4],borderColor:e[4],type:"pie"},title:{text:""},plotOptions:{pie:{shadow:!1,enableMouseTracking:!1,borderColor:e[4],animation:!1,innerSize:"64%",size:"108%"}},tooltip:{formatter:function(){return!1}},exporting:{enabled:!1},credits:{enabled:!1},series:[{name:"Versions",data:i,dataLabels:{enabled:!1}}]});return j?!0:void 0},a.updateStatusIp=function(b){$(b).unbind().click(function(){if($(this).hasClass("disabled"))return!1;a.hideAllMessages();var b=[],c=$(this).attr("rel");$(this).addClass("disabled"),b.push("param=null"),b.push("actionIp="+c),a.ajaxJson("/virtual-machines/servers/my-servers/getIp.json",b.join("&"),{method:"POST",async:!1,fnSuccess:a.updateStatusIpSuccess,fnError:a.genericCallbackError})})},a.updateStatusIpSuccess=function(b){var c=b.resume||!1,d=b.genericResponse||!1,e=b.instance||!1;c&&("solicitarIp"==c.actionIp?($(".private-available").addClass("hide"),$("#rebootIp").removeClass("hide"),$(".reiniciar").removeClass("hide")):"solicitarIpDesligado"==c.actionIp&&($(".private-available").addClass("hide"),$(".solicitarIpDesligado").addClass("hide"),$("#startIP").removeClass("hide"),$(".reiniciar").addClass("ligar-srv-desligado"),$(".ligar-srv-desligado .reiniciar-servidor").addClass("hide"),$(".ligar-srv-desligado .ligar-servidor").removeClass("hide"),$(".ligar-srv-desligado").removeClass("hide"))),a.errorHandler("#msg-error",d,e,!1)},a.atualizaLabelIp=function(a,b){$(b).size()>0&&$(b).html(a)},a.atualizaIpPrivado=function(a,b){""!==a&&($(b).addClass("hide"),$(".ip-privado").removeClass("hide"),$(".numero-ip").html(a))},a.atualizaIpPublico=function(a,b,c){var d,e,f=a.length,g=$(".ips table tbody .list-ip").length-1,h=$(".ips table tbody"),i=0;if(f!=g)for(i=g;f>i;i++)"ASSIGNED"==c[i]&&(e=$(".ips table tbody tr:last").clone(),d=$(".ips table tbody .list-ip:last").clone(),d.find("td:eq(1)").html(a[i]).closest("tr").find("td a.manage-firewall").attr("rel",b[i]),h.append(d),h.append(e))},a.ipAdd=function(){return $(this).hasClass("disabled")?!1:void $(".ipadd").click(function(){return tb_show("Contratar novo IP adicional","#TB_inline?height=150&width=480&inlineId=ip-adicional&modal=false",null),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .close"),!1})}(),a.privateIpProcedureCentOS=function(b){$(b).unbind().click(function(b){return b.preventDefault(),$(this).hasClass("disabled")?!1:(tb_show("Procedimento de ativação para CentOS","#TB_inline?height=550&width=560&inlineId=active-ip-private-centos&modal=false",null),void a.heightModal())}),$("a.close").add("a#TB_closeWindowButton").add("#TB_overlay").unbind().click(function(){tb_remove(),a.heightModal()}),$(".choice-ip").change(function(){$(".pop-active-ip-centos .privado,.pop-active-ip-centos .publico").addClass("hide"),$(".pop-active-ip-centos ."+$(this).val()).removeClass("hide")})},a.viewDetails=function(){$(".view-details > div").off().on("click",function(b){b.preventDefault();var c=$(this);$(this).hasClass("closed")?($(this).removeClass("closed"),$(".details").slideDown(function(){a.parentIframeAdjust($("#container")[0].offsetHeight)})):$(".details").slideUp(function(){c.addClass("closed"),a.parentIframeAdjust($("#container")[0].offsetHeight)}),a.parentIframeAdjust($("#container")[0].offsetHeight)})}(),a.helpAccessMachine=function(){$("a#first-access-win").add("a#first-access-lin").unbind().click(function(b){b.preventDefault(),tb_show("Como fazer o primeiro acesso:","#TB_inline?height=220&width=560&inlineId=first-access&modal=false",null),$("#windows").add("#linux").addClass("hide"),"first-access-win"==$(this).attr("id")?$("#windows").removeClass("hide"):$("#linux").removeClass("hide"),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent","#TB_ajaxContent .close");var c=$(".choice-os").clone();$(".help-skin").parents("#TB_window").find("#TB_ajaxWindowTitle").append(c),"first-access-win"==$(this).attr("id")&&"windows"==$(".choice-os option").eq(0).val()?$(".choice-os option").eq(0).attr("selected","selected"):$(".choice-os option").eq(1).attr("selected","selected"),$(".choice-os").removeClass("hide").unbind().change(function(){$(".help-skin div").each(function(){$(this).hasClass("hide")||$(this).addClass("hide")}),$("#"+$('select[class="choice-os"] option:selected').val()).removeClass("hide")}),a.heightModal()})}(),a.submitToCreate=function(b){$(b).on("click",function(b){if(b.preventDefault(),$(this).hasClass("disabled"))return!1;var c,d=$(this).attr("rel"),e=$(this).attr("id"),f=$(this).attr("rev"),g=$(this).data("url");c=[],c.push("idtServer="+d),a.ajaxJson("/virtual-machines/servers/edit/get.json",c.join("&"),{method:"POST",fnSuccess:function(b){var c=b.get||!1,h=b.error||!1,i=b.genericResponse||!1,j=b.sessionStatus||!1,k=$("#qtd_templates").val();0===parseInt(c.attachedDisks,10)&&"STOPPED"==c.statusLabel&&k<a.TEMPLATE_LIMIT?($("#fieldaction").val(e),$("#fieldvalue").val(f),$("#idinstance").val(d),$("#manage").attr("action",g).submit()):(tb_show("Criar template","#TB_inline?height=210&width=560&inlineId=modal-template&modal=false",null),a.heightModal(),$(".cloud-templates > div").addClass("hide"),$(".disconnect-server").add(".disconnect-disks").attr("rel",c.controlRequest),parseInt(c.attachedDisks,10)>0&&"RUNNING"==c.statusLabel?($(".disconnect-tpl-all").removeClass("hide"),a.disconnect(".disconnect-server","disconnect")):parseInt(c.attachedDisks,10)>0?($(".disconnect-tpl-disks").removeClass("hide"),a.dispatcherDetachDisks(".disconnect-disks")):"RUNNING"==c.statusLabel?($(".disconnect-tpl").removeClass("hide"),a.disconnect(".disconnect-server","disconnect")):k>=a.TEMPLATE_LIMIT&&$(".max-tpl").removeClass("hide"),a.centralizeButtons("#TB_ajaxContent .actions","#TB_ajaxContent",".actions:visible .btn:first",".actions:visible .close")),a.errorHandler(".exception",h,i,j,!1)},fnError:function(b){a.genericCallbackError(b)}})})}("#create-template")};
//# sourceMappingURL=vms.servers.edit.map